# Oracle XE Database connection - Puerto 1522 para evitar conflictos
quarkus.datasource.db-kind=oracle
quarkus.datasource.username=datum_user
quarkus.datasource.password=datum2025
quarkus.datasource.jdbc.url=jdbc:oracle:thin:@localhost:1522/XEPDB1

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Hibernate ORM Configuration
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 
# OPCIONES DE DATABASE.GENERATION:
# 
# 1. drop-and-create â†’ Borra y recrea tablas cada vez (SOLO PARA DESARROLLO INICIAL)
#    âš ï¸ PIERDE TODOS LOS DATOS al reiniciar!
# 
# 2. update â†’ Actualiza el esquema sin borrar datos (RECOMENDADO PARA DESARROLLO)
#    âœ… MANTIENE los datos existentes
#    âœ… Agrega nuevas columnas/tablas si detecta cambios
#    âš ï¸ No elimina columnas obsoletas
# 
# 3. validate â†’ Solo valida que el esquema coincida (PRODUCCIÃ“N)
#    âœ… No modifica nada
#    âŒ Falla si hay diferencias
# 
# 4. none â†’ No hace nada (PRODUCCIÃ“N con Flyway/Liquibase)
#    âœ… Control manual de migraciones
# 
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# âœ… CONFIGURACIÃ“N ACTUAL: Persistir datos entre reinicios
quarkus.hibernate-orm.database.generation=update
quarkus.hibernate-orm.log.sql=true

# âš ï¸ DESACTIVAR import.sql para evitar inserciones automÃ¡ticas
# El archivo import.sql se ejecuta SOLO si existe y database.generation != none
# Para REACTIVAR datos iniciales, descomentar la siguiente lÃ­nea:
# quarkus.hibernate-orm.sql-load-script=import.sql
quarkus.hibernate-orm.sql-load-script=no-file

# Puerto del servidor
quarkus.http.port=8081
quarkus.http.host=0.0.0.0

# CORS - Para que el Frontend se conecte sin problemas
quarkus.http.cors=true
quarkus.http.cors.origins=${FRONTEND_ORIGINS:*}
quarkus.http.cors.methods=GET,POST,PUT,DELETE,PATCH,OPTIONS
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
quarkus.http.cors.exposed-headers=Content-Disposition
quarkus.http.cors.access-control-max-age=24H

# ============================================================================
# MULTIPART/FORM-DATA - Para subir imÃ¡genes (OCR)
# ============================================================================
quarkus.http.body.handle-file-uploads=true
quarkus.http.limits.max-body-size=10M
quarkus.http.body.uploads-directory=/tmp/datum-uploads

# ALMACENAMIENTO DE ARCHIVOS
app.storage.path=/tmp/datum-files
app.storage.images.max-size=5242880


# LOGGING
quarkus.log.level=INFO
quarkus.log.category."datum.travels".level=DEBUG
quarkus.log.category."org.hibernate.SQL".level=DEBUG
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n

# DESARROLLO - Hot Reload
quarkus.live-reload.instrumentation=true

# SWAGGER para testing
quarkus.swagger-ui.always-include=true
quarkus.swagger-ui.path=/swagger-ui

# ============================================================================
# CORREOS ELECTRÓNICOS - Configuración de Proveedores por País
# ============================================================================
# Correos de contabilidad para cada país de Centroamérica
app.email.proveedores.sv=12.hectorcarlos.777@gmail.com
app.email.proveedores.gt=12.hectorcarlos.777@gmail.com
app.email.proveedores.hn=12.hectorcarlos.777@gmail.com
app.email.proveedores.pa=12.hectorcarlos.777@gmail.com
app.email.proveedores.cr=12.hectorcarlos.777@gmail.com

# ============================================================================
# MAILER - Configuración SMTP
# ============================================================================
# Gmail configurado para desarrollo con App Password

# Configuración Gmail
quarkus.mailer.from=12.hectorcarlos.777@gmail.com
quarkus.mailer.host=smtp.gmail.com
quarkus.mailer.port=587
quarkus.mailer.start-tls=REQUIRED
quarkus.mailer.username=12.hectorcarlos.777@gmail.com
quarkus.mailer.password=iglxddrgbthfrell

# Mock mode DESACTIVADO para enviar correos reales
quarkus.mailer.mock=false

# ============================================================================
# AZURE STORAGE - Para acceso a imágenes de comprobantes
# ============================================================================
azure.storage.account-name=${AZURE_STORAGE_ACCOUNT_NAME:storageocr2025}
azure.storage.account-key=${AZURE_STORAGE_ACCOUNT_KEY:}
azure.storage.container-name=${AZURE_STORAGE_CONTAINER_NAME:ocr-files}

# EMAILS POR PAÍS (LEGACY - mantener para compatibilidad)
app.email.contabilidad.sv=contabilidad.sv@datum.com
app.email.contabilidad.gt=contabilidad.gt@datum.com
app.email.contabilidad.hn=contabilidad.hn@datum.com
app.email.contabilidad.pa=contabilidad.pa@datum.com

# ============================================================================
# API DE CONVERSIÃ“N DE MONEDAS (exchangerate-api.com)
# ============================================================================
# 1. Registrarse en: https://www.exchangerate-api.com/
# 2. Plan gratuito: 1,500 requests/mes (suficiente para ~50 gastos/dÃ­a)
# 3. Copiar tu API Key y agregarla al archivo .env
# 
# âš ï¸ Mientras uses DEMO_KEY, el servicio usarÃ¡ tasas aproximadas (fallback)
# ============================================================================
exchangerate.api.key=${EXCHANGERATE_API_KEY:DEMO_KEY}
exchangerate.api.url=${EXCHANGERATE_API_URL:https://v6.exchangerate-api.com/v6}

# KEYCLOAK CONFIGURATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# âœ… OIDC HABILITADO para validar JWT de Keycloak
quarkus.oidc.enabled=true
quarkus.oidc.devservices.enabled=false

# URL del servidor Keycloak (AUTH SERVER)
quarkus.oidc.auth-server-url=${KEYCLOAK_AUTH_SERVER_URL:http://${KEYCLOAK_HOST:localhost}:8180/realms/datum-travels}

# Cliente de backend (para validar tokens)
quarkus.oidc.client-id=datum-app
# No necesitamos client-secret porque usamos Password Grant desde frontend

# ConfiguraciÃ³n de token
quarkus.oidc.token.issuer=${KEYCLOAK_TOKEN_ISSUER:http://${KEYCLOAK_HOST:localhost}:8180/realms/datum-travels}
quarkus.oidc.token.principal-claim=preferred_username

# URLs pÃºblicas (no requieren autenticaciÃ³n)
quarkus.http.auth.permission.public.paths=/api/auth/*,/q/*,/swagger-ui/*
quarkus.http.auth.permission.public.policy=permit

# URLs protegidas (requieren JWT vÃ¡lido)
quarkus.http.auth.permission.authenticated.paths=/api/*
quarkus.http.auth.permission.authenticated.policy=authenticated

# Configuracion de admin client para crear usuarios en Keycloak
keycloak.admin.url=${KEYCLOAK_ADMIN_URL:http://localhost:8180}
keycloak.admin.realm=${KEYCLOAK_ADMIN_REALM:datum-travels}
keycloak.admin.client-id=${KEYCLOAK_ADMIN_CLIENT_ID:admin-cli}
keycloak.admin.username=admin
keycloak.admin.password=admin123
keycloak.admin.default-role=${KEYCLOAK_ADMIN_DEFAULT_ROLE:usuario}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# LOGGING (para debugging de autenticaciÃ³n y OIDC)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
quarkus.log.category."io.quarkus.oidc".level=DEBUG
quarkus.log.category."io.quarkus.security".level=DEBUG


